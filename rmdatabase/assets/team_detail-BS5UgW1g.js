import{u as A,m as H,V,_ as L,a as C,b as x,c as M,d as R}from"./VRow-DOkVDV4d.js";import{g as U,p as q,e as z,u as G,b as u,m as J,f as K,h as Q,i as W,_ as X,r as Y,c as b,o as g,w as _,a as d,j as v,F as D,k as F,d as B,l as T,t as y}from"./index-CI_-Xnhs.js";import{V as Z}from"./VCheckboxBtn-Og5j4nqI.js";import{V as $}from"./VBtn-DPLsAgcc.js";const tt=q({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...Q(),...H(),...K(),...J()},"VTable"),at=U()({name:"VTable",props:tt(),setup(i,l){let{slots:n,emit:p}=l;const{themeClasses:h}=z(i),{densityClasses:k}=A(i);return G(()=>u(i.tag,{class:["v-table",{"v-table--fixed-height":!!i.height,"v-table--fixed-header":i.fixedHeader,"v-table--fixed-footer":i.fixedFooter,"v-table--has-top":!!n.top,"v-table--has-bottom":!!n.bottom,"v-table--hover":i.hover},h.value,k.value,i.class],style:i.style},{default:()=>{var f,r,c;return[(f=n.top)==null?void 0:f.call(n),n.default?u("div",{class:"v-table__wrapper",style:{height:W(i.height)}},[u("table",null,[n.default()])]):(r=n.wrapper)==null?void 0:r.call(n),(c=n.bottom)==null?void 0:c.call(n)]}})),{}}}),st={data(){return{data:null,data_final:null,data_center:null,logo_maps:null,tableData:[],tabulator:null,school_data:{},school_data_average:{},school_logo:null,team_name:"",rank_data:{},name_maps:{base:"基地",damage:"伤害",money:"经济",long_shot:"吊射",bullet_big:"大弹丸数",bullet_small:"小弹丸数",kill:"击杀",duff:"大小能量机关",radar:"雷达",drone:"无人机",dart:"飞镖",经济伤害转化率:"经济伤害转化率",吊射效率:"吊射效率",伤害转换效率:"伤害转换效率"},data_scope:null,selected_scopes:["全国赛"],chartOption:null}},async mounted(){this.team_name=this.$route.params.name,await this.updateData();for(const i of Object.keys(this.logo_maps))this.team_name.includes(i)&&(this.school_logo=this.logo_maps[i])},methods:{async updateData(){var w,O;this.chartOption={color:["#67F9D8","#FFE434","#56A3F1","#FF917C"],title:{text:"雷达图目前计算方式有争议，以下数据暂时撤回。征集更好的计算方式。 ",left:"center"},legend:{},radar:[{indicator:[{text:"辅瞄",max:.5},{text:"战术",max:.5},{text:"经济",max:5e3},{text:"远程",max:1},{text:"稳定性",max:32}],center:["50%","50%"],radius:120,startAngle:90,splitNumber:4,shape:"circle",axisName:{formatter:"{value}",color:"#428BD4"},splitArea:{areaStyle:{color:["#77EADF","#26C3BE","#64AFE9","#428BD4"],shadowColor:"rgba(0, 0, 0, 0.2)",shadowBlur:10}},axisLine:{lineStyle:{color:"rgba(211, 253, 250, 0.8)"}},splitLine:{lineStyle:{color:"rgba(211, 253, 250, 0.8)"}}}],series:[{type:"radar",emphasis:{lineStyle:{width:4}},data:[{value:[100,100,100,100,100],name:"",areaStyle:{color:"rgba(255, 228, 52, 0.6)"}}]}]};const i=async(t,a=3)=>{for(let s=0;s<a;s++)try{const o=await fetch(t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){if(s===a-1)throw o;await new Promise(I=>setTimeout(I,1e3))}};try{[this.data_final,this.data_center,this.logo_maps]=await Promise.all([i("/rmdatabase/data.json"),i("/rmdatabase/data_center.json"),i("/rmdatabase/college_names_logo_maps.json")]),this.data_scope={全国赛:this.data_final,中部赛区:this.data_center}}catch(t){console.error("Failed to load data:",t)}this.data=[],this.school_data={},this.school_data_average={},this.tableData=[],this.rank_data={};for(const t of this.selected_scopes)for(const a in this.data_scope[t])this.data.push(this.data_scope[t][a]);var l=this.data.sort((t,a)=>t.id-a.id),n=[];for(const t of l){var p={};p.id=t.id,p.blue=t.blue,p.red=t.red,p.data=[];for(const a of t.data){var h={};h.blue=a.blue,h.red=a.red;for(const s in a)for(const o in a[s])if(o=="bullet"){var k=a[s][o].split("/");h[s].bullet_big=k[0],h[s].bullet_small=k[1],delete h[s][o]}else h[s][o]=a[s][o];p.data.push(h)}n.push(p)}for(const t of n){var f=t.blue,r=t.red;f=f.trim(),r=r.trim(),this.school_data[f]||(this.school_data[f]={name:f,data:{}}),this.school_data[r]||(this.school_data[r]={name:r,data:{}});for(const a of t.data)for(const s in a){if(s=="blue")for(const o in a[s])this.school_data[f].data[o]||(this.school_data[f].data[o]=[]),this.school_data[f].data[o].push(a[s][o]);if(s=="red")for(const o in a[s])this.school_data[r].data[o]||(this.school_data[r].data[o]=[]),this.school_data[r].data[o].push(a[s][o])}}for(const t in this.school_data){this.school_data_average[t]={name:this.school_data[t].name,data:{}};for(const a in this.school_data[t].data){var c=0;for(const s of this.school_data[t].data[a])c+=parseInt(s);this.school_data_average[t].data[a]=c/this.school_data[t].data[a].length}}for(const t in this.school_data)for(const a in this.school_data[t].data){var c=0;for(const o of this.school_data[t].data[a])c+=Math.pow(parseInt(o)-this.school_data_average[t].data[a],2);this.school_data_average[t].data[a+"_std"]=Math.sqrt(c/this.school_data[t].data[a].length)}for(const t in this.school_data_average){var e={};e.name=this.school_data_average[t].name;for(const a in this.school_data_average[t].data)e[a]=this.school_data_average[t].data[a];e.经济伤害转化率=e.damage/e.money,e.long_shot&&e.bullet_big&&(e.long_shot=parseInt(e.long_shot),e.bullet_big=parseInt(e.bullet_big),e.吊射效率=e.long_shot/e.bullet_big),e.伤害转换效率=e.damage/(e.bullet_big*200+e.bullet_small*10),this.tableData.push(e)}for(const t in this.tableData)if(this.tableData[t].name==this.team_name){for(const a in this.tableData[t])if(a!="name"){this.rank_data[a]={rank:1,value:this.tableData[t][a]};for(const s in this.tableData)this.tableData[s].name==this.team_name||!this.tableData[s].name.includes("战队")||this.tableData[s][a]>this.tableData[t][a]&&this.rank_data[a].rank++}}var j=0;for(const t in this.rank_data)this.rank_data[t].rank>0&&(j+=this.rank_data[t].rank);var m={};for(const t in this.tableData)for(const a in this.tableData[t])a!="name"&&(m[a]||(m[a]=0),this.tableData[t][a]>m[a]&&(m[a]=this.tableData[t][a]));for(const t in this.tableData)for(const a in this.tableData[t])a!="name"&&a.includes("std")&&(this.tableData[t][a]=this.tableData[t][a]/m[a]);var N=0;for(const t in m)t.includes("std")&&(N+=m[t]);var P=0;for(const t in this.rank_data)t.includes("std")&&(this.rank_data[t].value=this.rank_data[t].value/m[t],P+=this.rank_data[t].value);this.chartOption.radar[0].indicator[0].max=m.伤害转换效率,this.chartOption.radar[0].indicator[1].max=m.经济伤害转化率,this.chartOption.radar[0].indicator[2].max=m.money,this.chartOption.radar[0].indicator[3].max=m.long_shot+m.dart,console.log(this.chartOption.radar[0].indicator[3].max),isNaN(this.chartOption.radar[0].indicator[3].max)&&(this.chartOption.radar[0].indicator.splice(3,1),this.chartOption.series[0].data[0].value.splice(3,1)),console.log(this.chartOption.radar[0].indicator),this.chartOption.series[0].data[0].value=[this.chartOption.radar[0].indicator[0].max,this.chartOption.radar[0].indicator[1].max,this.chartOption.radar[0].indicator[2].max,this.chartOption.radar[0].indicator[3].max,(O=(w=this.chartOption.radar[0])==null?void 0:w.indicator[4])==null?void 0:O.max],console.log(this.chartOption.series[0].data[0].value);var E=document.getElementById("radarChart"),S=echarts.init(E);S.setOption(this.chartOption)}}},ot={class:"mb-8 text-center",style:{width:"100%","max-width":"900px"}},et={class:"text-h5 font-weight-bold"},it={class:"ml-6"},nt={class:"px-4",style:{width:"100%"}},rt={key:0},lt={key:0},ht={key:1},ct={key:2};function dt(i,l,n,p,h,k){const f=Y("router-link");return g(),b(R,{class:"fill-height d-flex flex-column align-center justify-center"},{default:_(()=>[d("div",ot,[u(f,{to:"/",style:{"text-decoration":"none",color:"inherit"}},{default:_(()=>[u(V,{height:"50",src:L})]),_:1})]),u(C,{class:"w-100",style:{"max-width":"1200px"},justify:"center"},{default:_(()=>[u(x,{cols:"12",class:"pa-0"},{default:_(()=>[u(M,{class:"py-4 w-100",color:"surface-variant","prepend-icon":"mdi-rocket-launch-outline",rounded:"lg",variant:"tonal"},{image:_(()=>[u(V,{src:h.school_logo,height:"100px",position:"top right",class:"mr-12 mt-8"},null,8,["src"])]),title:_(()=>[u(C,null,{default:_(()=>[u(x,{cols:"10"},{default:_(()=>[d("h3",et,y(this.team_name),1)]),_:1}),u(x,{cols:"2",class:"d-flex justify-center"})]),_:1})]),subtitle:_(()=>l[1]||(l[1]=[d("div",{class:"text-subtitle-1"}," 多纬度数据排名 ",-1)])),default:_(()=>[d("div",it,[(g(!0),v(D,null,F(h.data_scope,(r,c)=>(g(),b(Z,{modelValue:h.selected_scopes,"onUpdate:modelValue":l[0]||(l[0]=e=>h.selected_scopes=e),label:c,value:c,key:c,density:"compact",class:"mx-2","hide-details":""},null,8,["modelValue","label","value"]))),128)),u($,{class:"mt-4 mr-9",color:"primary",onClick:k.updateData,style:{"margin-left":"20px"}},{default:_(()=>l[2]||(l[2]=[B(" 查询数据 ")])),_:1},8,["onClick"])]),d("div",nt,[u(at,{style:{width:"100%"},class:"pa-4"},{default:_(()=>[l[3]||(l[3]=d("thead",null,[d("tr",null,[d("th",{class:"text-left"},"指标"),d("th",{class:"text-left"},"排名"),d("th",{class:"text-left"},"数据")])],-1)),(g(!0),v(D,null,F(h.rank_data,(r,c)=>(g(),v("tbody",{key:c},[h.name_maps[c]?(g(),v("tr",rt,[d("td",null,y(h.name_maps[c]),1),d("td",null,[B(" #"+y(r.rank)+" ",1),r.rank===1?(g(),v("span",lt,"🥇")):r.rank===2?(g(),v("span",ht,"🥈")):r.rank===3?(g(),v("span",ct,"🥉")):T("",!0)]),d("td",null,y(r.value.toFixed(2)),1)])):T("",!0)]))),128))]),_:1})]),l[4]||(l[4]=d("div",{class:"ml-6"},null,-1)),l[5]||(l[5]=d("div",{id:"radarChart",style:{width:"100%",height:"400px"}},null,-1))]),_:1})]),_:1})]),_:1})]),_:1})}const ut=X(st,[["render",dt]]),gt={__name:"team_detail",setup(i){return(l,n)=>{const p=ut;return g(),b(p)}}};export{gt as default};
