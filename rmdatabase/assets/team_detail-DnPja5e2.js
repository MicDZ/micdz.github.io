import{u as S,m as A,V as w,_ as I,a as D,b,c as H,d as L}from"./VRow-CcVJ3vZk.js";import{g as M,p as R,e as U,u as q,b as u,m as z,f as G,h as J,i as K,_ as Q,r as W,c as x,o as g,w as _,a as c,j as v,F as V,k as C,d as F,l as O,t as y}from"./index-CypW1mk9.js";import{V as X}from"./VCheckboxBtn-DWK-0Pc3.js";import{V as Y}from"./VBtn-Cs-GNvJz.js";const Z=R({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...J(),...A(),...G(),...z()},"VTable"),$=M()({name:"VTable",props:Z(),setup(o,l){let{slots:n,emit:p}=l;const{themeClasses:r}=U(o),{densityClasses:k}=S(o);return q(()=>u(o.tag,{class:["v-table",{"v-table--fixed-height":!!o.height,"v-table--fixed-header":o.fixedHeader,"v-table--fixed-footer":o.fixedFooter,"v-table--has-top":!!n.top,"v-table--has-bottom":!!n.bottom,"v-table--hover":o.hover},r.value,k.value,o.class],style:o.style},{default:()=>{var f,i,h;return[(f=n.top)==null?void 0:f.call(n),n.default?u("div",{class:"v-table__wrapper",style:{height:K(o.height)}},[u("table",null,[n.default()])]):(i=n.wrapper)==null?void 0:i.call(n),(h=n.bottom)==null?void 0:h.call(n)]}})),{}}}),aa={data(){return{data:null,data_final:null,data_center:null,logo_maps:null,tableData:[],tabulator:null,school_data:{},school_data_average:{},school_logo:null,team_name:"",rank_data:{},name_maps:{base:"基地",damage:"伤害",money:"经济",long_shot:"吊射",bullet_big:"大弹丸数",bullet_small:"小弹丸数",kill:"击杀",duff:"大小能量机关",radar:"雷达",drone:"无人机",dart:"飞镖",经济伤害转化率:"经济伤害转化率",吊射效率:"吊射效率",伤害转换效率:"伤害转换效率"},data_scope:null,selected_scopes:["全国赛"],chartOption:{color:["#67F9D8","#FFE434","#56A3F1","#FF917C"],title:{text:"雷达图目前计算方式有争议，以下数据暂时撤回。征集更好的计算方式。 ",left:"center"},legend:{},radar:[{indicator:[{text:"辅瞄",max:.5},{text:"战术",max:.5},{text:"经济",max:5e3},{text:"远程",max:1},{text:"稳定性",max:32}],center:["50%","50%"],radius:120,startAngle:90,splitNumber:4,shape:"circle",axisName:{formatter:"{value}",color:"#428BD4"},splitArea:{areaStyle:{color:["#77EADF","#26C3BE","#64AFE9","#428BD4"],shadowColor:"rgba(0, 0, 0, 0.2)",shadowBlur:10}},axisLine:{lineStyle:{color:"rgba(211, 253, 250, 0.8)"}},splitLine:{lineStyle:{color:"rgba(211, 253, 250, 0.8)"}}}],series:[{type:"radar",emphasis:{lineStyle:{width:4}},data:[{value:[100,100,100,100,100],name:"",areaStyle:{color:"rgba(255, 228, 52, 0.6)"}}]}]}}},async mounted(){this.team_name=this.$route.params.name,await this.updateData();for(const o of Object.keys(this.logo_maps))this.team_name.includes(o)&&(this.school_logo=this.logo_maps[o])},methods:{async updateData(){const o=async(a,t=3)=>{for(let s=0;s<t;s++)try{const e=await fetch(a);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){if(s===t-1)throw e;await new Promise(N=>setTimeout(N,1e3))}};try{[this.data_final,this.data_center,this.logo_maps]=await Promise.all([o("/rmdatabase/data.json"),o("/rmdatabase/data_center.json"),o("/rmdatabase/college_names_logo_maps.json")]),this.data_scope={全国赛:this.data_final,中部赛区:this.data_center}}catch(a){console.error("Failed to load data:",a)}this.data=[],this.school_data={},this.school_data_average={},this.tableData=[],this.rank_data={};for(const a of this.selected_scopes)for(const t in this.data_scope[a])this.data.push(this.data_scope[a][t]);var l=this.data.sort((a,t)=>a.id-t.id),n=[];for(const a of l){var p={};p.id=a.id,p.blue=a.blue,p.red=a.red,p.data=[];for(const t of a.data){var r={};r.blue=t.blue,r.red=t.red;for(const s in t)for(const e in t[s])if(e=="bullet"){var k=t[s][e].split("/");r[s].bullet_big=k[0],r[s].bullet_small=k[1],delete r[s][e]}else r[s][e]=t[s][e];p.data.push(r)}n.push(p)}for(const a of n){var f=a.blue,i=a.red;f=f.trim(),i=i.trim(),this.school_data[f]||(this.school_data[f]={name:f,data:{}}),this.school_data[i]||(this.school_data[i]={name:i,data:{}});for(const t of a.data)for(const s in t){if(s=="blue")for(const e in t[s])this.school_data[f].data[e]||(this.school_data[f].data[e]=[]),this.school_data[f].data[e].push(t[s][e]);if(s=="red")for(const e in t[s])this.school_data[i].data[e]||(this.school_data[i].data[e]=[]),this.school_data[i].data[e].push(t[s][e])}}for(const a in this.school_data){this.school_data_average[a]={name:this.school_data[a].name,data:{}};for(const t in this.school_data[a].data){var h=0;for(const s of this.school_data[a].data[t])h+=parseInt(s);this.school_data_average[a].data[t]=h/this.school_data[a].data[t].length}}for(const a in this.school_data)for(const t in this.school_data[a].data){var h=0;for(const e of this.school_data[a].data[t])h+=Math.pow(parseInt(e)-this.school_data_average[a].data[t],2);this.school_data_average[a].data[t+"_std"]=Math.sqrt(h/this.school_data[a].data[t].length)}for(const a in this.school_data_average){var d={};d.name=this.school_data_average[a].name;for(const t in this.school_data_average[a].data)d[t]=this.school_data_average[a].data[t];d.经济伤害转化率=d.damage/d.money,d.吊射效率=d.long_shot/d.bullet_big,d.伤害转换效率=d.damage/(d.bullet_big*200+d.bullet_small*10),this.tableData.push(d)}for(const a in this.tableData)if(this.tableData[a].name==this.team_name){for(const t in this.tableData[a])if(t!="name"){this.rank_data[t]={rank:1,value:this.tableData[a][t]};for(const s in this.tableData)this.tableData[s].name==this.team_name||!this.tableData[s].name.includes("战队")||this.tableData[s][t]>this.tableData[a][t]&&this.rank_data[t].rank++}}var B=0;for(const a in this.rank_data)this.rank_data[a].rank>0&&(B+=this.rank_data[a].rank);var m={};for(const a in this.tableData)for(const t in this.tableData[a])t!="name"&&(m[t]||(m[t]=0),this.tableData[a][t]>m[t]&&(m[t]=this.tableData[a][t]));for(const a in this.tableData)for(const t in this.tableData[a])t!="name"&&t.includes("std")&&(this.tableData[a][t]=this.tableData[a][t]/m[t]);var T=0;for(const a in m)a.includes("std")&&(T+=m[a]);var j=0;for(const a in this.rank_data)a.includes("std")&&(this.rank_data[a].value=this.rank_data[a].value/m[a],j+=this.rank_data[a].value);this.chartOption.radar[0].indicator[0].max=m.伤害转换效率,this.chartOption.radar[0].indicator[1].max=m.经济伤害转化率,this.chartOption.radar[0].indicator[2].max=m.money,this.chartOption.radar[0].indicator[3].max=m.long_shot+m.dart,this.chartOption.radar[0].indicator[4].max=1,this.chartOption.series[0].data[0].value=[this.chartOption.radar[0].indicator[0].max,this.chartOption.radar[0].indicator[1].max,this.chartOption.radar[0].indicator[2].max,this.chartOption.radar[0].indicator[3].max,this.chartOption.radar[0].indicator[4].max];var P=document.getElementById("radarChart"),E=echarts.init(P);E.setOption(this.chartOption)}}},ta={class:"mb-8 text-center",style:{width:"100%","max-width":"900px"}},sa={class:"text-h5 font-weight-bold"},ea={class:"ml-6"},oa={class:"px-4",style:{width:"100%"}},na={key:0},ia={key:0},la={key:1},ra={key:2};function ha(o,l,n,p,r,k){const f=W("router-link");return g(),x(L,{class:"fill-height d-flex flex-column align-center justify-center"},{default:_(()=>[c("div",ta,[u(f,{to:"/",style:{"text-decoration":"none",color:"inherit"}},{default:_(()=>[u(w,{height:"50",src:I})]),_:1})]),u(D,{class:"w-100",style:{"max-width":"1200px"},justify:"center"},{default:_(()=>[u(b,{cols:"12",class:"pa-0"},{default:_(()=>[u(H,{class:"py-4 w-100",color:"surface-variant","prepend-icon":"mdi-rocket-launch-outline",rounded:"lg",variant:"tonal"},{image:_(()=>[u(w,{src:r.school_logo,height:"100px",position:"top right",class:"mr-12 mt-8"},null,8,["src"])]),title:_(()=>[u(D,null,{default:_(()=>[u(b,{cols:"10"},{default:_(()=>[c("h3",sa,y(this.team_name),1)]),_:1}),u(b,{cols:"2",class:"d-flex justify-center"})]),_:1})]),subtitle:_(()=>l[1]||(l[1]=[c("div",{class:"text-subtitle-1"}," 多纬度数据排名 ",-1)])),default:_(()=>[c("div",ea,[(g(!0),v(V,null,C(r.data_scope,(i,h)=>(g(),x(X,{modelValue:r.selected_scopes,"onUpdate:modelValue":l[0]||(l[0]=d=>r.selected_scopes=d),label:h,value:h,key:h,density:"compact",class:"mx-2","hide-details":""},null,8,["modelValue","label","value"]))),128)),u(Y,{class:"mt-4 mr-9",color:"primary",onClick:k.updateData,style:{"margin-left":"20px"}},{default:_(()=>l[2]||(l[2]=[F(" 查询数据 ")])),_:1},8,["onClick"])]),c("div",oa,[u($,{style:{width:"100%"},class:"pa-4"},{default:_(()=>[l[3]||(l[3]=c("thead",null,[c("tr",null,[c("th",{class:"text-left"},"指标"),c("th",{class:"text-left"},"排名"),c("th",{class:"text-left"},"数据")])],-1)),(g(!0),v(V,null,C(r.rank_data,(i,h)=>(g(),v("tbody",{key:h},[r.name_maps[h]?(g(),v("tr",na,[c("td",null,y(r.name_maps[h]),1),c("td",null,[F(" #"+y(i.rank)+" ",1),i.rank===1?(g(),v("span",ia,"🥇")):i.rank===2?(g(),v("span",la,"🥈")):i.rank===3?(g(),v("span",ra,"🥉")):O("",!0)]),c("td",null,y(i.value.toFixed(2)),1)])):O("",!0)]))),128))]),_:1})]),l[4]||(l[4]=c("div",{class:"ml-6"},null,-1)),l[5]||(l[5]=c("div",{id:"radarChart",style:{width:"100%",height:"400px"}},null,-1))]),_:1})]),_:1})]),_:1})]),_:1})}const da=Q(aa,[["render",ha]]),_a={__name:"team_detail",setup(o){return(l,n)=>{const p=da;return g(),x(p)}}};export{_a as default};
