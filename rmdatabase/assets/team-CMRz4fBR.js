import{V as x,_ as w,a as v,b as g,c as y,d as k}from"./VRow-CcVJ3vZk.js";import{_ as C,r as j,c as V,o as b,w as l,a as r,b as i,d as T}from"./index-CypW1mk9.js";import{V as D}from"./VSelect-XozASH3G.js";import{V as E}from"./VBtn-Cs-GNvJz.js";import"./VCheckboxBtn-DWK-0Pc3.js";const B={data(){return{data:null,data_final:null,data_center:null,logo_maps:null,tableData:[],tabulator:null,school_data:{},school_data_average:{},dataOptions:["2024赛季全国赛","2024赛季分区赛·中部赛区"],selectedData:"2024赛季全国赛"}},async mounted(){this.renderMath(),this.loadData()},methods:{renderMath(){document.querySelectorAll("span.math").forEach(s=>{const u=s.getAttribute("data-katex");u&&katex.render(u,s,{throwOnError:!1})})},async loadData(){const m=async(t,a=3)=>{for(let e=0;e<a;e++)try{const o=await fetch(t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){if(e===a-1)throw o;await new Promise(F=>setTimeout(F,1e3))}};try{[this.data_final,this.data_center,this.logo_maps]=await Promise.all([m("/rmdatabase/data.json"),m("/rmdatabase/data_center.json"),m("/rmdatabase/college_names_logo_maps.json")]),this.data_scope={全国赛:this.data_final,中部赛区:this.data_center}}catch(t){console.error("Failed to load data:",t)}this.selectedData=="2024赛季全国赛"?(this.tableData=[],this.school_data={},this.school_data_average={},this.data=this.data_final):this.selectedData=="2024赛季分区赛·中部赛区"&&(this.tableData=[],this.school_data={},this.school_data_average={},this.data=this.data_center);var s=this.data.sort((t,a)=>t.id-a.id),u=[];for(const t of s){var f={};f.id=t.id,f.blue=t.blue,f.red=t.red,f.data=[];for(const a of t.data){var d={};d.blue=a.blue,d.red=a.red;for(const e in a)for(const o in a[e])if(o=="bullet"){var p=a[e][o].split("/");d[e].bullet_big=p[0],d[e].bullet_small=p[1],delete d[e][o]}else d[e][o]=a[e][o];f.data.push(d)}u.push(f)}for(const t of u){var c=t.blue,h=t.red;c=c.trim(),h=h.trim(),this.school_data[c]||(this.school_data[c]={name:c,data:{}}),this.school_data[h]||(this.school_data[h]={name:h,data:{}});for(const a of t.data)for(const e in a){if(e=="blue")for(const o in a[e])this.school_data[c].data[o]||(this.school_data[c].data[o]=[]),this.school_data[c].data[o].push(a[e][o]);if(e=="red")for(const o in a[e])this.school_data[h].data[o]||(this.school_data[h].data[o]=[]),this.school_data[h].data[o].push(a[e][o])}}for(const t in this.school_data){this.school_data_average[t]={name:this.school_data[t].name,data:{}};for(const a in this.school_data[t].data){var _=0;for(const e of this.school_data[t].data[a])_+=parseInt(e);this.school_data_average[t].data[a]=_/this.school_data[t].data[a].length}}for(const t in this.school_data_average){var n={};n.name=this.school_data_average[t].name;for(const a in this.school_data_average[t].data)n[a]=this.school_data_average[t].data[a];n.经济伤害转化率=n.damage/n.money,n.吊射效率=n.long_shot/n.bullet_big,n.伤害转换效率=n.damage/(n.bullet_big*200+n.bullet_small*10),this.tableData.push(n)}this.tabulator=new Tabulator("#table",{data:this.tableData,layout:"fitDataTable",columnVertAlign:"bottom",maxWidth:"100%",columns:[{title:"队伍名称",field:"name"},{title:"操作",formatter:"html",cellClick:(function(t,a){var e=a.getRow().getData().name;this.$router.push({path:"/team_detail/"+e})}).bind(this),formatter:function(){return"<span style='color: #1976D2; cursor: pointer;'>查看详情</span>"}},{title:"经济伤害转化率",field:"经济伤害转化率",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"伤害转换效率",field:"伤害转换效率",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"吊射效率",field:"吊射效率",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"基地血量",field:"base",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"经济",field:"money",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"伤害",field:"damage",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"击毁数",field:"kill",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"大弹丸数",field:"bullet_big",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"小弹丸数",field:"bullet_small",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"吊射",field:"long_shot",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"大小能量机关",field:"duff",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"无人机",field:"drone",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"飞镖",field:"dart",formatter:t=>parseFloat(t.getValue()).toFixed(2)},{title:"雷达",field:"radar",formatter:t=>parseFloat(t.getValue()).toFixed(2)}]})}}},P={class:"mb-8 text-center",style:{width:"100%","max-width":"900px"}},A={class:"ml-6"};function N(m,s,u,f,d,p){const c=j("router-link");return b(),V(k,{class:"fill-height d-flex flex-column align-center justify-center"},{default:l(()=>[r("div",P,[i(c,{to:"/",style:{"text-decoration":"none",color:"inherit"}},{default:l(()=>[i(x,{height:"50",src:w})]),_:1})]),i(v,{class:"w-100",style:{"max-width":"1200px"},justify:"center"},{default:l(()=>[i(g,{cols:"12",class:"pa-0 mb-4"},{default:l(()=>[i(y,{class:"py-4 w-100",color:"surface-variant","prepend-icon":"mdi-math-integral",rounded:"lg",variant:"tonal"},{image:l(()=>[i(x,{position:"top right"})]),title:l(()=>s[1]||(s[1]=[r("h2",{class:"text-h5 font-weight-bold"}," 计算公式 ",-1)])),default:l(()=>[s[2]||(s[2]=r("div",{class:"ml-6"},[r("span",{class:"math","data-katex":"经济伤害转化率 = \\frac{伤害}{经济}"}),r("br"),r("span",{class:"math","data-katex":"伤害转换效率 = \\frac{伤害}{200 \\times 大弹丸数 + 10 \\times 小弹丸数}"}),r("br"),r("span",{class:"math","data-katex":"吊射效率 = \\frac{吊射}{大弹丸数}"}),r("br")],-1))]),_:1})]),_:1}),i(g,{cols:"12",class:"pa-0"},{default:l(()=>[i(y,{class:"py-4 w-100 mb-4",color:"surface-variant","prepend-icon":"mdi-chevron-triple-up",rounded:"lg",variant:"tonal"},{image:l(()=>[i(x,{position:"top right"})]),title:l(()=>s[3]||(s[3]=[r("h2",{class:"text-h5 font-weight-bold"}," 各战队数据统计 ",-1)])),subtitle:l(()=>s[4]||(s[4]=[r("div",{class:"text-subtitle-1"}," 目前支持2024赛季全国赛所有比赛数据 ",-1)])),default:l(()=>[r("div",A,[i(v,null,{default:l(()=>[i(g,{cols:"5"},{default:l(()=>[i(D,{modelValue:d.selectedData,"onUpdate:modelValue":s[0]||(s[0]=h=>d.selectedData=h),items:d.dataOptions,label:"选择数据",outlined:"",dense:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"2"},{default:l(()=>[i(E,{onClick:p.loadData,color:"primary",class:"mt-2"},{default:l(()=>s[5]||(s[5]=[T("加载数据")])),_:1},8,["onClick"])]),_:1})]),_:1})]),s[6]||(s[6]=r("div",{style:{"max-width":"100%",display:"flex","justify-content":"center"},class:"pa-3"},[r("div",{id:"table",style:{"max-width":"100%","overflow-x":"auto"}})],-1))]),_:1})]),_:1})]),_:1})]),_:1})}const O=C(B,[["render",N]]),q={__name:"team",setup(m){return(s,u)=>{const f=O;return b(),V(f)}}};export{q as default};
