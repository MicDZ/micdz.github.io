/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /gh/pcooksey/bibtex-js@1.0.0/src/bibtex_js.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function BibtexParser(){this.pos=0,this.input="",this.entries={},this.strings={JAN:"January",FEB:"February",MAR:"March",APR:"April",MAY:"May",JUN:"June",JUL:"July",AUG:"August",SEP:"September",OCT:"October",NOV:"November",DEC:"December"},this.currentKey="",this.rawCurrentKey="",this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.getBibTexRaw=function(){return this.bibtexraw},this.errorThrown=function(t){$("#bibtex_errors").html(t)},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t){if(this.skipWhitespace(),this.input.substring(this.pos,this.pos+t.length)!=t)throw"Token mismatch, expected "+t+", found "+this.input.substring(this.pos);this.pos+=t.length,this.skipWhitespace()},this.tryMatch=function(t){return this.skipWhitespace(),this.input.substring(this.pos,this.pos+t.length)==t},this.skipWhitespace=function(){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace()}},this.value_braces=function(){var t=0;this.match("{");for(var a=this.pos;;){if("}"==this.input[this.pos]&&"\\"!=this.input[this.pos-1]){if(!(t>0)){var r=this.pos;return this.match("}"),this.input.substring(a,r)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos==this.input.length-1)throw"Unterminated value";this.pos++}},this.value_quotes=function(){var t=0;this.match('"');for(var a=this.pos;;){if('"'==this.input[this.pos]&&"\\"!=this.input[this.pos-1]&&0==t){var r=this.pos;return this.match('"'),this.input.substring(a,r)}if("{"==this.input[this.pos])t++;else if("}"==this.input[this.pos])t>0&&t--;else if(this.pos==this.input.length-1)throw"Unterminated value:"+this.input.substring(a);this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var a=this.key();if(this.strings[a.toUpperCase()])return this.strings[a];if(a.match("^[0-9]+$"))return a;throw"Value expected:"+this.input.substring(t)},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(){for(var t=this.pos;;){if(this.pos==this.input.length)throw"Runaway key";if(!this.input[this.pos].match("[a-zA-Z0-9_:?\\./'\\+\\-\\*]"))return this.rawCurrentKey=this.input.substring(t,this.pos),this.rawCurrentKey.toUpperCase();this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("="))return this.match("="),[t,this.value()];throw"... = value expected, equals sign missing:"+this.input.substring(this.pos)},this.key_value_list=function(){var t=this.key_equals_value();for(this.entries[this.currentEntry][t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}")&&!this.tryMatch(")"));)t=this.key_equals_value(),this.entries[this.currentEntry][t[0]]=t[1]},this.entry_body=function(t){this.currentEntry=this.key(),this.entries[this.currentEntry]=new Object,this.entries[this.currentEntry].BIBTEXKEY=this.rawCurrentKey,"@INCOLLECTION"==t?this.entries[this.currentEntry].BIBTEXTYPE="book chapter":"@INPROCEEDINGS"==t?this.entries[this.currentEntry].BIBTEXTYPE="conference, workshop":"@ARTICLE"==t?this.entries[this.currentEntry].BIBTEXTYPE="journal":"@TECHREPORT"==t&&(this.entries[this.currentEntry].BIBTEXTYPE="technical report"),this.entries[this.currentEntry].BIBTEXTYPEKEY=t.substr(1),this.match(","),this.key_value_list()},this.directive=function(){return this.match("@"),"@"+this.key()},this.string=function(){var t=this.key_equals_value();this.strings[t[0].toUpperCase()]=t[1]},this.preamble=function(){this.value()},this.comment=function(){this.pos=this.input.indexOf("}",this.pos)},this.entry=function(t){this.entry_body(t)},this.bibtex=function(){for(var t=0,a=0;this.tryMatch("@");){t=this.pos;var r=this.directive().toUpperCase();this.tryMatch("{")?this.match("{"):this.match("("),"@STRING"==r?this.string():"@PREAMBLE"==r?this.preamble():"@COMMENT"==r?this.comment():this.entry(r),a=this.pos+1,this.tryMatch("}")?this.match("}"):this.match(")"),this.tryMatch(",")&&this.match(","),this.pos=a+this.input.substring(a,this.input.length).indexOf("@"),this.entries[this.currentEntry].BIBTEXRAW=this.input.substring(t,a)}}}function BibtexDisplay(){this.invert=function(t){var a={};for(var r in t)t.hasOwnProperty(r)&&(a[t[r]]=r);return a},this.regExps=[],this.regExps.push(new RegExp("{\\\\\\W*\\w+}")),this.regExps.push(new RegExp("\\\\\\W*{\\w+}")),this.regExps.push(new RegExp("\\\\\\W*\\w+\\s")),this.regExps.push(new RegExp("\\\\\\W*\\w+")),this.regExps.push(new RegExp("\\\\(?![:\\\\])\\W{1}")),this.fixValue=function(t){do{var a=t.match(/^\{(.*?)\}$/g,"$1");a&&(t=t.replace(/^\{(.*?)\}$/g,"$1"))}while(a);if(t.indexOf("\\")>-1)for(var r in this.regExps)do{var h=t.match(this.regExps[r]),s=h?h[0]:"";if(h)if(void 0!==latex_to_unicode[s])t=t.replace(s,latex_to_unicode[s]);else{var e=s.replace(new RegExp("(\\w)"),"{$1}");void 0!==latex_to_unicode[e]?t=t.replace(s,latex_to_unicode[e]):h=""}else h=""}while(h.length);return t=t.replace(/[\{|\}]/g,"")},this.getName=function(t){var a=["","","","",""];switch(t.length){case 1:for(var r=t[0].split(/\ \s?(?![^\{]*\})/),h=0;h<r.length-1;h++){var s=h>0?" ":"";if("{"==r[h][0]){if("\\"!=r[h][1]){a[0]+=s+this.fixValue(r[h]);continue}r[h]=this.fixValue(r[h])}if(r[h][0]!=r[h][0].toUpperCase())break;a[0]+=s+this.fixValue(r[h])}for(var e=h,i=h;i<r.length-1;i++)r[i][0]==r[i][0].toLowerCase()&&(e=i);for(;h<=e&&h<r.length-1;h++){s=""!=a[2]?" ":"";a[2]+=s+this.fixValue(r[h])}for(;h<r.length;h++){s=""!=a[3]?" ":"";a[3]+=s+this.fixValue(r[h])}break;case 2:case 3:var n=0;for(r=t[n].split(/\ \s?(?![^\{]*\})/),e=-1,i=h=0;i<r.length-1;i++)r[i][0]==r[i][0].toLowerCase()&&(e=i);for(;h<=e&&h<r.length-1;h++){s=""!=a[2]?" ":"";a[2]+=s+this.fixValue(r[h])}for(;h<r.length;h++){s=""!=a[3]?" ":"";a[3]+=s+this.fixValue(r[h])}n++,3==t.length&&(a[1]=this.fixValue(t[n]),n++),a[0]=this.fixValue(t[n]);break;default:return console.log("Processed author incorrectly!"),a}return""!=a[0]&&(a[4]=a[0].split(" ").map((t=>t.substring(0,1).toUpperCase())).join(". ")+"."),a};var t=Object.freeze({FIRST:0,JUNIOR:1,VON:2,LAST:3,FIRST_INITIAL:4});this.displayAuthor=function(a,r){var h=(a=(a=a.replace(/[ ]*[\n\t][ ]*/g," ")).replace(/[ ]+/g," ")).split(new RegExp(/\s+and\s+?(?![^\{]*\})/)),s=h.length;r.attr("max")&&(s=Math.min(r.attr("max"),s)),conjunction=r.attr("conjunction")?r.attr("conjunction"):", and",conjunction="<span class='bibtex_js_conjunction'>"+conjunction+"</span>";var e="";for(i=0;i<s;i++){var n=this.getName(h[i].split(/\,\s?(?![^\{]*\})/)),m=r.clone(),l=$.grep(n.slice(0,4),Boolean).join(" ");m.attr("class",l);var c=!1;for(j=0,ele=m.find("span:not(a)"),len=ele.length;j<len;++j){var f=t[ele[j].getAttribute("class").toUpperCase()];""!=n[f]?(ele[j].hasAttribute("bibtex-js-rif")&&!c?ele[j].textContent=n[f]:ele[j].textContent=ele[j].textContent+n[f],c=!0):ele[j].remove()}0==i?e+=m[0].outerHTML:i+1>=h.length?e+=conjunction+" "+m[0].outerHTML:e+=", "+m[0].outerHTML}return s!=h.length&&(s>1&&(e+=","),e+=" et al."),e},this.createTemplate=function(t,a){if(a[0].attributes.length>1)for(var r=0,h=a[0].attributes,s=h.length;r<s;++r){var e=h[r].nodeName.toUpperCase(),i=h[r].nodeValue;if(e in t&&!t[e].match(i))return null}var n=$(".bibtex_template").clone().removeClass("bibtex_template"),m=[];for(var l in t)m.push(l.toUpperCase());for(var c=new RegExp("\\s*[\\|\\|]\\s*","gi"),f=new RegExp("\\s*==\\s*","gi");;){var b=n.find(".if");if(0==b.length)break;var o=b.first();o.removeClass("if");var p=!1,g=o.attr("class").split(c),u=this;$.each(g,(function(a,r){var h=r.split(f);2==h.length?m.indexOf(h[0].toUpperCase())>0&&u.fixValue(t[h[0].toUpperCase()])==h[1]&&(p|=!0):("!"==r[0]&&m.indexOf(r.substring(1,r.length).toUpperCase())<0||m.indexOf(r.toUpperCase())>0)&&(p|=!0),o.removeClass(r)})),p||o.remove()}for(var d in n.find(".bibtexVar").each((function(){var a=$(this).attr("extra").toUpperCase(),r=new RegExp("\\+"+a+"\\+","gi"),h=t[a];$(this)[0].hasAttribute("bibtexjs-css-escape")&&(h=h.replace(/[\!\#\$\%\&\'\(\)\*\+\,\.\/\:\;\<\=\>\?\@\[\\\]\^\`\{\|\}\~ ]/g,"\\$&")),$.each(this.attributes,(function(t,a){var s=a.value;s=s.replace(r,h),a.value=s}))})),m){l=m[d],i=t[l]||"";if("BIBTEXRAW"!=l){if("AUTHOR"==l){var y=n.find("span:not(a)."+l.toLowerCase());y.length&&(i=this.displayAuthor(i,y))}else"PAGES"==l?i=i.replace("--","-"):"DATE"==l?i=moment(i).format("MMM. YYYY"):"URL"==l?(i=i.replace(/\\url/g,""),i=this.fixValue(i)):i=this.fixValue(i);n.find("span:not(a)."+l.toLowerCase()).html(i),n.find("a."+l.toLowerCase()).each((function(){$(this).attr("href")||$(this).attr("href",i)}))}else n.find("."+l.toLowerCase()).html(i)}return n.addClass("bibtexentry"),n},this.createArray=function(t){var a=[];for(var r in t)a.push(t[r]);return a},this.sortArray=function(t,a,r,h){var s=a.toUpperCase();return t=t.sort((function(t,a){var e="",i="";if(e=s in t?t[s]:"",i=s in a?a[s]:"","DATE"==s){var n=t=>("MONTH"in t?t.MONTH:"Jan")+" 1, "+("YEAR"in t?t.YEAR:"1900");e||(e=n(t)),i||(i=n(a))}else if("YEAR"==s){var m=t=>"DATE"in t?moment(t.DATE).format("YYYY"):"";e||(e=m(t)),i||(i=m(a))}switch(r.toUpperCase()){case"DESC":break;case"ASC":var l=i;i=e,e=l;break;default:return 0}switch(h.toLowerCase()){case"string":return i.toUpperCase().localeCompare(e.toUpperCase());case"number":return parseInt(i)-parseInt(e);case"date":return new Date(i)-new Date(e);default:return 0}}))},this.createStructure=function(t,a,r,h){var s="Other Publications";h=h||0;var e=t.clone().removeClass("bibtex_structure"),i=e.children(".group"),n=e.children(".sections"),m=e.children(".sort");if(i.length){var l=i.first(),c=l.attr("class").split(" ")[1].toUpperCase(),f=l.attr("extra").split(" ")[0],b=l.attr("extra").split(" ")[1],o=this.sortArray(r,c,f,b),p=[];$.each(o,(function(t,a){c in a&&-1===$.inArray(a[c],p)&&p.push(a[c])})),p.push(s);var g=$(".bibtex_topics");for(val in globalStruct=$("<div></div>"),p){var u=e.clone(),d=p[val],y=u.children("."+c.toLowerCase()).first().find(".title");if(y.length?(y.prepend(this.fixValue(d)),y.attr("id",this.fixValue(d))):u.children("."+c.toLowerCase()).first().prepend("<h"+(h+1)+" class='"+c+"' id=\""+d+'">'+this.fixValue(d)+"</h"+(h+1)+">"),splicedArray=$.grep(o,(function(t,a){return d==s?void 0===t[c]:t[c]==d})),splicedArray.length){g.length&&0==h&&g.append(' - <a href="#'+d+'"> '+d+" </a>");var E=this.createStructure(i.clone(),a,splicedArray,h+1);i.children(".group").length?(nextGroupName="."+i.children(".group").attr("class").split(" ").join("."),u.find(nextGroupName).replaceWith(E.find(nextGroupName))):u.find(".templates").append(E.find(".templates").html()),0==h?a.append(u):globalStruct.append(u)}}return 0==h?a:globalStruct}if(n.length){p=[];var v=[],x=[],C=n.first().attr("class").split(" ")[1].toUpperCase();$(".section",".sections").each((function(t,a){p.push($(this).attr("class").split(" ")[1].toUpperCase()),v.push($(this))}));g=$(".bibtex_topics");globalStruct=$("<div></div>");u=e.clone();for(val in p){var w=p[val],R=new RegExp(w);if(splicedArray=$.grep(r,(function(t,a){return R.test(t[C])})),splicedArray.length){if(g.length&&0==h){var k=v[val].children().first().text();g.append(' - <a href="#'+w+'"> '+k+" </a>")}E=this.createStructure(v[val].clone(),a,splicedArray,h+1);i.children(".group").length?(nextGroupName="."+i.children(".group").attr("class").split(" ").join("."),u.find(nextGroupName).replaceWith(E.find(nextGroupName))):u.find(".templates").eq(val).append(E.find(".templates").html()),0==h?a.append(u):globalStruct.append(u)}else x.push(u.find(".section").eq(val))}for(val in x)x[val].remove();return 0==h?a:globalStruct}if(!m.length){for(var q in r){var Y=r[q];if(!Y.WEB||"NO"!=Y.WEB.toUpperCase()){var A=this.createTemplate(Y,a);if(A)if(t.find(".templates").append(A),A.show(),A.attr("callback"))new Function("bibtexentry",A.attr("callback"))(A[0])}}return t}var T=m.attr("class").split(" ")[1].toUpperCase();f=m.first().attr("extra").split(" ")[0],b=m.first().attr("extra").split(" ")[1],t.children(".sort").first().clone(),o=this.sortArray(r,T,f,b);if(0!=h)return this.createStructure(m,a,o,h+1);a.append(this.createStructure(m,a,o,h+1))},this.displayBibtex=function(t,a){var r=new BibtexParser;r.setInput(t);try{r.bibtex()}catch(t){r.errorThrown(t),console.error(t)}var h=r.getEntries(),s=a.find("*"),e=$(".bibtex_structure").clone();if(e.length){var i=this.createArray(h);this.createStructure(e,a,i)}else for(var n in h){var m=h[n];if(tpl=this.createTemplate(m,a),tpl)if(a.append(tpl),tpl.show(),tpl.attr("callback"))new Function("bibtexentry",tpl.attr("callback"))(tpl[0])}s.remove()}}function bibtex_js_draw(){$(".bibtex_template").hide();var t="",a=[];$("#bibtex_input").length&&(t+=$("#bibtex_input").val()),$("bibtex").each((function(r,h){var s=$.ajax({url:$(this).attr("src"),dataType:"text"}).done((a=>t+=a)).fail(((t,a,r)=>console.error(r)));a.push(s)}));var r=$(".bibtex_template").find("span:not(a).author");r.length&&!r.find("span:not(a)").length&&(r.append($("<span></span>").attr("class","first")),r.append($("<span></span>").attr("class","von").attr("bibtex-js-rif","").text(" ")),r.append($("<span></span>").attr("class","last").attr("bibtex-js-rif","").text(" ")),r.append($("<span></span>").attr("class","junior").text(", "))),$.when.apply($,a).then((function(){if($("#bibtex_display").length){var a=$("#bibtex_display");if((new BibtexDisplay).displayBibtex(t,a),a.attr("callback"))new Function("bibtex_display",a.attr("callback"))(a[0])}else $(".bibtex_display").length&&$(".bibtex_display").each((function(a){((new BibtexDisplay).displayBibtex(t,$(this)),$(this).attr("callback"))&&new Function("bibtex_display",$(this).attr("callback"))($(this)[0])}));$(".bibtex_structure").remove(),loadExtras()}))}function BibTeXSearcher(){this.inputArray=new Array(""),this.inputLength=0,this.setInputArray=function(t){this.inputArray=t,this.inputLength=t.length},this.getStringName=function(t){var a=t.indexOf("@")+1,r=t.indexOf("[",a),h=[];return-1==r?h[0]=t.substring(a,t.length):(h[0]=t.substring(a,r),end_pos2=t.indexOf("]",a),h[1]=t.substring(r+1,end_pos2)),h},this.checkEntry=function(t,a){var r=!1;if("@"!=a[0])t.find("span:not(.noread)").each((function(){if($(this).text().search(new RegExp(a,"i"))>-1&&t.is(":visible"))return r=!0,!1}));else{var h=a.split("="),s=this.getStringName(h[0]);if(s.length<2)t.find("span:not(.noread)."+s[0]).each((function(){if($(this).text().search(new RegExp(h[1],"i"))>-1&&t.is(":visible"))return r=!0,!1}));else if("first"===s[1])t.find("span:not(.noread)."+s[0]).each((function(){if(arrayString=$(this).text().split(new RegExp(",[\\s]+and[\\s]+|,[\\s]+")),h[1]==arrayString[0]&&t.is(":visible"))return r=!0,!1}))}return r},this.unhideAll=function(){$("div#bibtex_display, div.bibtex_display").children().each((function(){$(this).show(),$(this).find(".bibtexentry").each((function(){$(this).show()}))}))},this.hideEntry=function(t){var a=this,r=$("div#bibtex_display, div.bibtex_display").children();r.first().hasClass("bibtexentry")?r.each((function(){a.checkEntry($(this),t)||$(this).hide()})):r.each((function(){var r=!0;$(this).find(".bibtexentry:visible").each((function(){a.checkEntry($(this),t)?r=!1:$(this).hide()})),r&&$(this).hide()}))},this.searcher=function(t,a){a=void 0!==a&&a;var r=t;if(r.length){var h=r.split("%");if(this.inputLength>h.length||0==this.inputLength)a=!0;else if(this.inputArray[this.inputArray.length-1].length>h[h.length-1].length)a=!0;else for(var s=0;s<this.inputArray.length-1;s++)if(this.inputArray[s]!=h[s]){a=!0;break}if(a)for(var e in this.unhideAll(),h)this.hideEntry(h[e]);else this.hideEntry(h[h.length-1]);this.setInputArray(h)}else this.unhideAll()}}function createWebPage(t){$(document).ready((function(){0==$(".bibtex_template").length&&$("body").append(t),bibtex_js_draw()}))}function loadExtras(){BibTeXSearcherClass=new BibTeXSearcher,$("select").each((function(){for(var t=0,a=this.classList.length;t<a;++t){var r=this.classList[t].match(/bibtex_generate_(.*)/);if(r){var h=r[1];generateList($(this),h)}}})),localStorage.removeItem("customerDatabase"),localStorage.searcher||(localStorage.searcher=new Object),$("select").each((function(){localStorage.getItem($(this).attr("id"))&&$(this).val(JSON.parse(localStorage.getItem($(this).attr("id"))))})),$(".bibtex_search").each((function(t,a){$(this).on("change",(function(t){combineSearcher(BibTeXSearcherClass,!0),localStorage.setItem($(this).attr("id"),JSON.stringify($(this).val()))})),$(this).keyup((function(){combineSearcher(BibTeXSearcherClass)})),a.length>0&&""!=$(this).val()&&combineSearcher(BibTeXSearcherClass,!0)}))}function combineSearcher(t,a){a=void 0!==a&&a;var r="";$("select.bibtex_search").each((function(t,a){var h="";a.hasAttribute("search")&&(h="@"+$(this).attr("search")),a.hasAttribute("extra")?h+="["+$(this).attr("extra")+"]=":""!=h&&(h+="="),""!=$(this).val()&&(r+="%"+h+$(this).val())})),$("input.bibtex_search").each((function(t,a){""!=$(this).val()&&(r+="%"+$(this).val().split(" ").join("%"))})),t.searcher(r,a)}function generateList(t,a){var r=new Object,h=[];if("author"==a)for(var s in $(".bibtexentry span.author").each((function(a,h){for(authors=$(this).children("span:not(.bibtex_js_conjunction)"),authorLength=authors.length,"first"==t.attr("extra")&&(author